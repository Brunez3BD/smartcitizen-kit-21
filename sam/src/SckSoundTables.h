#ifndef ALIGN4
#define ALIGN4 __attribute__ ((aligned (4))) ///< align to 4 bytes
#endif

const int16_t hannWindow[512] = {
	0,1,4,11,19,30,44,60,79,100,123,149,178,208,242,277,316,356,399,445,492,543,595,650,708,767,830,894,961,1030,1102,1175,1251,1330,1410,1493,1579,1666,1756,1847,1941,2038,2136,2237,2339,2444,2551,2660,2771,2884,2999,3117,3236,3357,3480,3605,3732,3861,3992,4125,4259,4396,4534,4674,4816,4959,5105,5252,5400,5551,5703,5856,6011,6168,6326,6486,6647,6810,6974,7140,7307,7475,7645,7816,7989,8162,8337,8513,8690,8869,9048,9229,9411,9594,9778,9962,10148,10335,10523,10711,10901,11091,11282,11474,11666,11860,12054,12248,12443,12639,12836,13033,13230,13428,13626,13825,14024,14224,14424,14624,14824,15025,15226,15427,15628,15829,16030,16232,16433,16635,16836,17038,17239,17440,17641,17842,18042,18242,18442,18642,18841,19040,19239,19437,19635,19832,20029,20225,20420,20615,20810,21003,21196,21388,21580,21770,21960,22149,22337,22525,22711,22896,23080,23264,23446,23627,23807,23986,24164,24341,24517,24691,24864,25035,25206,25375,25543,25709,25874,26037,26199,26360,26519,26677,26832,26987,27140,27291,27440,27588,27734,27879,28021,28162,28301,28439,28574,28708,28839,28969,29097,29223,29348,29470,29590,29708,29824,29939,30051,30161,30269,30375,30478,30580,30679,30777,30872,30965,31056,31144,31230,31314,31396,31476,31553,31628,31700,31771,31839,31904,31968,32029,32087,32144,32197,32249,32298,32344,32389,32430,32470,32507,32541,32573,32603,32630,32655,32677,32697,32714,32729,32741,32751,32759,32764,32766,32766,32764,32759,32751,32741,32729,32714,32697,32677,32655,32630,32603,32573,32541,32507,32470,32430,32389,32344,32298,32249,32197,32144,32087,32029,31968,31904,31839,31771,31700,31628,31553,31476,31396,31314,31230,31144,31056,30965,30872,30777,30679,30580,30478,30375,30269,30161,30051,29939,29824,29708,29590,29470,29348,29223,29097,28969,28839,28708,28574,28439,28301,28162,28021,27879,27734,27588,27440,27291,27140,26987,26832,26677,26519,26360,26199,26037,25874,25709,25543,25375,25206,25035,24864,24691,24517,24341,24164,23986,23807,23627,23446,23264,23080,22896,22711,22525,22337,22149,21960,21770,21580,21388,21196,21003,20810,20615,20420,20225,20029,19832,19635,19437,19239,19040,18841,18642,18442,18242,18042,17842,17641,17440,17239,17038,16836,16635,16433,16232,16030,15829,15628,15427,15226,15025,14824,14624,14424,14224,14024,13825,13626,13428,13230,13033,12836,12639,12443,12248,12054,11860,11666,11474,11282,11091,10901,10711,10523,10335,10148,9962,9778,9594,9411,9229,9048,8869,8690,8513,8337,8162,7989,7816,7645,7475,7307,7140,6974,6810,6647,6486,6326,6168,6011,5856,5703,5551,5400,5252,5105,4959,4816,4674,4534,4396,4259,4125,3992,3861,3732,3605,3480,3357,3236,3117,2999,2884,2771,2660,2551,2444,2339,2237,2136,2038,1941,1847,1756,1666,1579,1493,1410,1330,1251,1175,1102,1030,961,894,830,767,708,650,595,543,492,445,399,356,316,277,242,208,178,149,123,100,79,60,44,30,19,11,4,1,0
};

const uint16_t armBitRevTable8[128] = {
0x80,0x40,0xC0,0x20,0xA0,0x60,0xE0,0x10,0x90,0x50,0xD0,0x30,0xB0,0x70,0xF0,0x8,0x88,0x48,0xC8,0x28,0xA8,0x68,0xE8,0x18,0x98,0x58,0xD8,0x38,0xB8,0x78,0xF8,0x4,0x84,0x44,0xC4,0x24,0xA4,0x64,0xE4,0x14,0x94,0x54,0xD4,0x34,0xB4,0x74,0xF4,0xC,0x8C,0x4C,0xCC,0x2C,0xAC,0x6C,0xEC,0x1C,0x9C,0x5C,0xDC,0x3C,0xBC,0x7C,0xFC,0x2,0x82,0x42,0xC2,0x22,0xA2,0x62,0xE2,0x12,0x92,0x52,0xD2,0x32,0xB2,0x72,0xF2,0xA,0x8A,0x4A,0xCA,0x2A,0xAA,0x6A,0xEA,0x1A,0x9A,0x5A,0xDA,0x3A,0xBA,0x7A,0xFA,0x6,0x86,0x46,0xC6,0x26,0xA6,0x66,0xE6,0x16,0x96,0x56,0xD6,0x36,0xB6,0x76,0xF6,0xE,0x8E,0x4E,0xCE,0x2E,0xAE,0x6E,0xEE,0x1E,0x9E,0x5E,0xDE,0x3E,0xBE,0x7E,0xFE,0x1
};

const int16_t ALIGN4 twiddleCoefQ15_512[512] =
{
32767,0,32766,402,32758,804,32746,1206,32729,1608,32706,2009,32679,2411,32647,2811,32610,3212,32568,3612,32522,4011,32470,4410,32413,4808,32352,5205,32286,5602,32214,5998,32138,6393,32058,6787,31972,7180,31881,7571,31786,7962,31686,8351,31581,8740,31471,9127,31357,9512,31238,9896,31114,10279,30986,10660,30853,11039,30715,11417,30572,11793,30425,12167,30274,12540,30118,12910,29957,13279,29792,13646,29622,14010,29448,14373,29269,14733,29086,15091,28899,15447,28707,15800,28511,16151,28311,16500,28106,16846,27897,17190,27684,17531,27467,17869,27246,18205,27020,18538,26791,18868,26557,19195,26320,19520,26078,19841,25833,20160,25583,20475,25330,20788,25073,21097,24812,21403,24548,21706,24279,22006,24008,22302,23732,22595,23453,22884,23170,23170,22884,23453,22595,23732,22302,24008,22006,24279,21706,24548,21403,24812,21097,25073,20788,25330,20475,25583,20160,25833,19841,26078,19520,26320,19195,26557,18868,26791,18538,27020,18205,27246,17869,27467,17531,27684,17190,27897,16846,28106,16500,28311,16151,28511,15800,28707,15447,28899,15091,29086,14733,29269,14373,29448,14010,29622,13646,29792,13279,29957,12910,30118,12540,30274,12167,30425,11793,30572,11417,30715,11039,30853,10660,30986,10279,31114,9896,31238,9512,31357,9127,31471,8740,31581,8351,31686,7962,31786,7571,31881,7180,31972,6787,32058,6393,32138,5998,32214,5602,32286,5205,32352,4808,32413,4410,32470,4011,32522,3612,32568,3212,32610,2811,32647,2411,32679,2009,32706,1608,32729,1206,32746,804,32758,402,32766,0,32767,-402,32766,-804,32758,-1206,32746,-1608,32729,-2009,32706,-2411,32679,-2811,32647,-3212,32610,-3612,32568,-4011,32522,-4410,32470,-4808,32413,-5205,32352,-5602,32286,-5998,32214,-6393,32138,-6787,32058,-7180,31972,-7571,31881,-7962,31786,-8351,31686,-8740,31581,-9127,31471,-9512,31357,-9896,31238,-10279,31114,-10660,30986,-11039,30853,-11417,30715,-11793,30572,-12167,30425,-12540,30274,-12910,30118,-13279,29957,-13646,29792,-14010,29622,-14373,29448,-14733,29269,-15091,29086,-15447,28899,-15800,28707,-16151,28511,-16500,28311,-16846,28106,-17190,27897,-17531,27684,-17869,27467,-18205,27246,-18538,27020,-18868,26791,-19195,26557,-19520,26320,-19841,26078,-20160,25833,-20475,25583,-20788,25330,-21097,25073,-21403,24812,-21706,24548,-22006,24279,-22302,24008,-22595,23732,-22884,23453,-23170,23170,-23453,22884,-23732,22595,-24008,22302,-24279,22006,-24548,21706,-24812,21403,-25073,21097,-25330,20788,-25583,20475,-25833,20160,-26078,19841,-26320,19520,-26557,19195,-26791,18868,-27020,18538,-27246,18205,-27467,17869,-27684,17531,-27897,17190,-28106,16846,-28311,16500,-28511,16151,-28707,15800,-28899,15447,-29086,15091,-29269,14733,-29448,14373,-29622,14010,-29792,13646,-29957,13279,-30118,12910,-30274,12540,-30425,12167,-30572,11793,-30715,11417,-30853,11039,-30986,10660,-31114,10279,-31238,9896,-31357,9512,-31471,9127,-31581,8740,-31686,8351,-31786,7962,-31881,7571,-31972,7180,-32058,6787,-32138,6393,-32214,5998,-32286,5602,-32352,5205,-32413,4808,-32470,4410,-32522,4011,-32568,3612,-32610,3212,-32647,2811,-32679,2411,-32706,2009,-32729,1608,-32746,1206,-32758,804,-32766,402
};
const double equalTab[256] = 
{
0.99944472020062,0.99944472020062,0.99944472020062,0.791691845437474,0.791691845437474,0.791691845437474,0.806874263578552,0.806874263578552,0.806874263578552,0.782391870292537,0.782391870292537,0.782391870292537,0.764008032973381,0.764008032973381,0.764008032973381,0.740836694406232,0.740836694406232,0.740836694406232,0.662813044723655,0.662813044723655,0.662813044723655,0.611065166756965,0.611065166756965,0.611065166756965,0.520677017563484,0.520677017563484,0.520677017563484,0.433648165790253,0.433648165790253,0.433648165790253,0.402717034325459,0.400405468330546,0.400405468330546,0.373680125382116,0.367456667203267,0.367456667203267,0.367705393378215,0.367705393378215,0.367705393378215,0.359534111407157,0.355802274039972,0.352297625781609,0.34901419582051,0.345946424091544,0.343089145597823,0.340437575927183,0.337987297906512,0.335734249341827,0.333674711796481,0.331805300364099,0.330122954396886,0.328624929153728,0.327308788336203,0.326172397484063,0.325213918205129,0.324431803217763,0.323824792187179,0.323391908339925,0.32313245584379,0.323046017943297,0.32313245584379,0.323391908339925,0.32382479218718,0.324431803217763,0.325213918205129,0.323738169086782,0.324779177396242,0.323391908339925,0.324692298997894,0.323391908339925,0.322096725738533,0.320806730335484,0.319521901356081,0.318242218108827,0.316967659985098,0.318924076738664,0.321064315438612,0.323391908339925,0.322355346616686,0.321322107364351,0.320292179933469,0.319265553708725,0.322096725738533,0.321150223092037,0.320206501806506,0.323391908339925,0.322527875888645,0.321666151943106,0.320806730335484,0.319949604914438,0.319094769545058,0.318242218108827,0.317391944503575,0.316543942643437,0.314854729896291,0.314854729896291,0.307876496099889,0.307876496099889,0.307876496099889,0.313916271389929,0.313916271389929,0.313916271389929,0.321084500271999,0.321084500271999,0.321084500271999,0.286182576041339,0.286182576041339,0.286182576041339,0.239482390696028,0.239482390696028,0.239482390696028,0.203592223809067,0.203592223809067,0.203592223809067,0.1993214258075,0.1993214258075,0.1993214258075,0.173421104726997,0.173421104726997,0.173421104726997,0.162462756050898,0.162462756050898,0.162462756050898,0.154442744054414,0.154442744054414,0.154442744054414,0.162557143503298,0.162557143503298,0.162557143503298,0.154139135132832,0.154139135132832,0.154139135132832,0.15697314489965,0.15697314489965,0.15697314489965,0.187846651771955,0.187846651771955,0.187846651771955,0.179904900185986,0.179904900185986,0.179904900185986,0.20127170175393,0.20127170175393,0.20127170175393,0.216756542147008,0.216756542147008,0.216756542147008,0.228911748756275,0.228911748756275,0.228911748756275,0.23984875408568,0.23984875408568,0.23984875408568,0.251379442523248,0.251379442523248,0.251379442523248,0.270319152447248,0.270319152447248,0.270319152447248,0.290508593675112,0.290508593675112,0.290508593675112,0.321140074158077,0.321140074158077,0.321140074158077,0.345147669966558,0.345147669966558,0.345147669966558,0.41635648232466,0.41635648232466,0.41635648232466,0.495075049751057,0.495075049751057,0.495075049751057,0.528201180096559,0.528201180096559,0.528201180096559,0.469953842903717,0.469953842903717,0.469953842903717,0.477037018994246,0.477037018994246,0.477037018994246,0.475322210052277,0.475322210052277,0.475322210052277,0.417864108903507,0.417864108903507,0.417864108903507,0.402016972133253,0.402016972133253,0.402016972133253,0.437008241675398,0.437008241675398,0.437008241675398,0.456826967994132,0.456826967994132,0.456826967994132,0.490968754638594,0.490968754638594,0.490968754638594,0.514222874090816,0.514222874090816,0.514222874090816,0.497511485534609,0.497511485534609,0.497511485534609,0.511219059235035,0.511219059235035,0.511219059235035,0.483774164217154,0.483774164217154,0.483774164217154,0.464262505496569,0.464262505496569,0.464262505496569,0.452826913887372,0.452826913887372,0.452826913887372,0.401219545565618,0.401219545565618,0.401219545565618,0.365331086170239,0.365331086170239,0.365331086170239,0.360903517452142,0.360903517452142,0.360903517452142,0.346880767326573,0.346880767326573,0.346880767326573,0.330530054676104,0.330530054676104,0.330530054676104,0.316352067750272,0.316352067750272,0.316352067750272,0.311288291773032,0.311288291773032,0.311288291773032,0.286594088045376,0.286594088045376,0.286594088045376,0.272890715662769,0.272890715662769,0.272890715662769,0.264896498560983,0.264896498560983,0.264896498560983,0.248666016452374,0.248666016452374,0.248666016452374,0.224274197399769,0.224274197399769,0.224274197399769,0.224274197399769
};

const double weightA[257] = 
{
0,0.0862538915555343,0.239252440067295,0.381499718566378,0.506174881840981,0.613491046469462,0.704657091342527,0.781358835632495,0.845492532387227,0.898943803532723,0.943446758613464,0.980518052821849,1.011442168756,1.03728522618051,1.05892148026641,1.07706317893995,1.09228900743996,1.10506909425038,1.11578603774419,1.12475213161783,1.13222326008119,1.13841000815891,1.14348650518794,1.14759745249792,1.15086370996276,1.15338674443019,1.15525218115916,1.15653264835139,1.15729006385055,1.15757748064798,1.15744058242197,1.15691890053426,1.15604680851176,1.15485433808098,1.15336785152296,1.15161059787385,1.14960317484241,1.14736391388858,1.144909202431,1.14225375441076,1.13941083827188,1.13639246969807,1.13320957507457,1.12987213054712,1.12638928067012,1.12276943992611,1.1190203798254,1.11514930382876,1.11116291195666,1.10706745663856,1.10286879110129,1.09857241138616,1.09418349291168,1.08970692235556,1.08514732551056,1.08050909166977,1.07579639501394,1.0710132134039,1.06616334492279,1.0612504224636,1.05627792661571,1.05124919706901,1.04616744272406,1.04103575067143,1.03585709418121,1.03063433982534,1.02537025383928,1.02006750781565,1.0147286838109,1.00935627893557,1.00395270948995,0.998520314699319,0.99306136009617,0.987578040591138,0.982072483269213,0.976546749943447,0.971002839494508,0.965442690021033,0.959868180822797,0.954281134236092,0.948683317338438,0.943076443537719,0.937462174059082,0.931842119341346,0.92621784035331,0.920590849839106,0.914962613500672,0.909334551124467,0.903708037658683,0.898084404246482,0.892464939220101,0.886850889060089,0.881243459323409,0.875643815543675,0.870053084106385,0.864472353101651,0.858902673156583,0.853345058249221,0.847800486505647,0.842269900981679,0.836754210430351,0.83125429005623,0.825770982257424,0.820305097356057,0.814857414317805,0.809428681461038,0.804019617155993,0.79863091051432,0.793263222069304,0.787917184446967,0.782593403028247,0.777292456602357,0.772014898011446,0.766761254786601,0.761532029775251,0.756327701759963,0.751148726068651,0.745995535176175,0.740868539297297,0.735768126970984,0.730694665635993,0.725648502197718,0.720629963586252,0.715639357305606,0.710676971974081,0.705743077855713,0.700837927382786,0.695961755669379,0.691114781015906,0.686297205404659,0.681509214986311,0.676750980557397,0.672022658028753,0.667324388884942,0.662656300634656,0.658018507252134,0.653411109609613,0.648834195900849,0.644287842055744,0.639772112146134,0.635287058782778,0.63083272350362,0.626409137153377,0.622016320254532,0.617654283369795,0.613323027456127,0.609022544210399,0.60475281640678,0.600513818225947,0.596305515576211,0.592127866406669,0.587980821012465,0.583864322332297,0.579778306238247,0.575722701818072,0.571697431650051,0.567702412070528,0.563737553434233,0.559802760367541,0.555897932014755,0.552022962277563,0.54817774004777,0.544362149433441,0.540576069978573,0.536819376876427,0.533091941176635,0.529393629986214,0.52572430666461,0.522083831012889,0.518472059457211,0.5148888452267,0.511334038525829,0.507807486701459,0.504309034404633,0.500838523747253,0.497395794453758,0.493980684007924,0.490593027794891,0.487232659238545,0.483899409934353,0.480593109777784,0.477313587088399,0.474060668729743,0.470834180225132,0.467633945869448,0.464459788837038,0.461311531285828,0.45818899445774,0.455091998775533,0.45202036393613,0.448973909000568,0.445952452480626,0.442955812422246,0.439983806485832,0.437036252023507,0.434112966153428,0.431213765831224,0.428338467918663,0.42548688924961,0.422658846693364,0.419854157215444,0.417072637935918,0.41431410618532,0.411578379558249,0.408865275964721,0.406174613679325,0.403506211388266,0.400859888234358,0.398235463860026,0.395632758448378,0.39305159276242,0.390491788182462,0.387953166741769,0.385435551160528,0.382938764878175,0.380462632084138,0.378006977747047,0.375571627642463,0.373156408379176,0.370761147424114,0.368385673125924,0.366029814737245,0.363693402435748,0.36137626734396,0.359078241547929,0.356799158114758,0.354538851109067,0.352297155608395,0.350073907717599,0.347868944582282,0.345682104401278,0.343513226438233,0.341362151032316,0.339228719608089,0.337112774684568,0.335014159883506,0.332932719936925,0.330868300693929,0.32882074912682,0.326789913336546,0.324775642557513,0.322777787161772,0.32079619866262,0.318830729717626,0.316881234131118,0.314947566856136,0.313029583995888,0.31112714280472,0.309240101688628,0.307368320205317,0.305511659063845,0.303669980123854,0.301843146394414,0.30003102203249,0.298233472341061,0.29645036376689,0.294681563897973
};
